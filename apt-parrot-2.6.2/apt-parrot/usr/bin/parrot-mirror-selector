#!/bin/bash

function list() {
	echo -e "Parrot Mirror Selector - set up the APT mirror you desire
		
MIRRORS
         codename -  speed   -  region       -   country       (provider)
 
            usa     -  1 Gbps  - north america  -   michigan      (LUG MTU)
            usa2    -  1 Gbps  - north america  - massachussetts  (SIPB MIT)
            usa3    -  1 Gbps  - north america  -   virginia      (JMU)
            usa4    -  1 Gbps  - north america  -   new york      (CLARKSON)
            euro    - 10 Gbps  -   europe       -    italy        (GARR)
            euro2   - 250 Mbps -   europe       -    france       (FROZENBOX)
            euro3   - 20 Gbps  -   europe       -   germany       (RWTH-AACHEN)
            euro4   -  1 Gbps  -   europe       -    italy        (dasaweb)
            asia    -  1 Gbps  -    asia        -    russia       (YANDEX)
            asia2   -  1 Gbps  -    asia        -  bangladesh     (DHAKACOM)
            asia3   - 250 Mbps -    asia        -     china       (YFGAO)
            sam     - 100 Mbps - south america  -    ecuador      (CEDIA)
            sam2    - 100 Mbps - south america  -    ecuador      (ESPOCH)
            sam3    - 100 Mbps - south america  -    ecuador      (UTA)
            meast   -  1 Gpbs  -  middle east   -     iran        (ASIS)
            ocean   -  1 Gbps  -   oceania      - new caledonia   (LAGOON)

BRANCHES
	current supported branches are
		stable   - our stable archive
		testing  - our development tree

AREAS
	current supported parameters are
		free     - includes only the main area
		nonfree  - includes main contrib non-free

USAGE
 	 parrot-mirror-selector <mirror> [branch] [archive area]

EXAMPLE
 	 parrot-mirror-selector asia stable free
"
}


branch="stable"
case $2 in
	stable)
		branch="stable"
	;;
	testing)
		branch="testing"
	;;
esac

areas="main contrib non-free"
case $3 in
	free)
		areas="main contrib non-free"
	;;
	nonfree)
		areas="main"
	;;
esac

case $1 in
	list)
		list
	;;
	usa)
		base="http://mirrors.mit.edu/parrot/"
	;;
	usa2)
		base="http://lug.mtu.edu/parrot/"
	;;
	usa3)
		base="http://mirror.jmu.edu/pub/parrot/"
	;;
	usa4)
		base="http://mirror.clarkson.edu/parrot/"
	;;
	euro)
		base="http://eu.archive.parrotsec.org/mirrors/parrot/"
	;;
	euro2)
		base="http://eu2.archive.parrotsec.org/parrot/"
	;;
	euro3)
		base="http://euro3.archive.parrotsec.org/parrotsec/"
	;;
	euro4)
		base="http://parrot.dasaweb.net/"
	;;
	asia)
		base="http://asia.archive.parrotsec.org/mirrors/parrot/"
	;;
	asia2)
		base="http://asia2.archive.parrotsec.org/parrotsec/"
	;;
	asia3)
		base="http://mirrors.yfgao.net/parrot/"
	;;
	sam)
		base="http://cedia.archive.parrotsec.org/parrot/"
	;;
	sam2)
		base="http://espoch.archive.parrotsec.org/parrot/"
	;;
	sam3)
		base="http://uta.archive.parrotsec.org/parrot/"
	;;
	meast)
		base="http://parrot.asis.io/parrot/"
	;;
	ocean)
		base="http://mirror.lagoon.nc/pub/parrot/"
	;;
	*)
		list
	;;
esac

if [ "$base" != "" ]; then
	if [ "$branch" != "" ]; then
		if [ "$areas" != "" ]; then
			echo "# parrot repository" > /etc/apt/sources.list.d/parrot.list
			echo "# this file was automatically generated by parrot-mirror-selector" >> /etc/apt/sources.list.d/parrot.list
			echo "deb $base $branch $areas" >> /etc/apt/sources.list.d/parrot.list
			echo "#deb-src $base $branch $areas" >> /etc/apt/sources.list.d/parrot.list
		fi
	fi
fi


